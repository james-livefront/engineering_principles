# Context Identification Rules
# How to determine what type of code is being reviewed

context_types:
  ui_code:
    description: "User interface and presentation layer code"
    detection:
      file_patterns:
        android:
          - "*Activity.kt"
          - "*Fragment.kt"
          - "*View.kt"
          - "*Adapter.kt"
          - "*/ui/*"
          - "*/presentation/*"
          - "*/layout/*.xml"
        
        ios:
          - "*ViewController.swift"
          - "*View.swift"
          - "*Cell.swift"
          - "*/UI/*"
          - "*/Views/*"
          - "*/ViewControllers/*"
        
        web:
          - "*.tsx"
          - "*.jsx"
          - "*Component.ts"
          - "*Component.js"
          - "*/components/*"
          - "*/pages/*"
          - "*.css"
          - "*.scss"
      
      imports:
        android:
          - "android.view"
          - "android.widget"
          - "androidx.compose"
          - "com.android.databinding"
        
        ios:
          - "UIKit"
          - "SwiftUI"
        
        web:
          - "react"
          - "react-dom"
          - "@emotion"
          - "styled-components"
      
      class_indicators:
        android:
          extends: ["Activity", "Fragment", "View", "RecyclerView.Adapter"]
          implements: ["View.OnClickListener"]
        
        ios:
          extends: ["UIViewController", "UIView", "UITableViewCell"]
          conforms: ["UITableViewDataSource", "UITableViewDelegate"]
        
        web:
          extends: ["Component", "PureComponent"]
          uses: ["useState", "useEffect", "render()"]

  business_logic:
    description: "Core application logic, data transformations, and algorithms"
    detection:
      file_patterns:
        all:
          - "*/domain/*"
          - "*/business/*"
          - "*/logic/*"
          - "*/models/*"
          - "*/entities/*"
          - "*/use_cases/*"
          - "*/usecases/*"
          - "*/repositories/*"
          - "*/services/*"
        
        exclude:
          - "*Test*"
          - "*Mock*"
          - "*Stub*"
      
      class_indicators:
        keywords: ["UseCase", "Repository", "Service", "Manager", "Calculator", "Validator", "Transformer"]
        excludes: ["ViewModel", "Presenter", "Controller"]
      
      method_patterns:
        - "calculate*"
        - "process*"
        - "transform*"
        - "validate*"
        - "parse*"
        - "convert*"

  data_layer:
    description: "Database, network, and persistence code"
    detection:
      file_patterns:
        all:
          - "*/data/*"
          - "*/database/*"
          - "*/network/*"
          - "*/api/*"
          - "*/cache/*"
          - "*/persistence/*"
      
      imports:
        android:
          - "retrofit2"
          - "okhttp3"
          - "androidx.room"
          - "android.database"
        
        ios:
          - "CoreData"
          - "URLSession"
          - "Alamofire"
        
        web:
          - "axios"
          - "fetch"
          - "graphql"
      
      class_indicators:
        suffixes: ["Api", "Database", "Dao", "Entity", "Remote", "Local", "Cache"]

  test_code:
    description: "Unit tests, integration tests, and test utilities"
    detection:
      file_patterns:
        all:
          - "*Test.*"
          - "*Tests.*"
          - "*Spec.*"
          - "*/test/*"
          - "*/tests/*"
          - "*/__tests__/*"
          - "*.test.*"
          - "*.spec.*"
      
      imports:
        android:
          - "org.junit"
          - "org.mockito"
          - "androidx.test"
        
        ios:
          - "XCTest"
          - "Quick"
          - "Nimble"
        
        web:
          - "jest"
          - "mocha"
          - "chai"
          - "@testing-library"

  configuration:
    description: "Build configs, dependency declarations, CI/CD"
    detection:
      file_patterns:
        all:
          - "*.gradle"
          - "*.gradle.kts"
          - "Package.swift"
          - "*.podspec"
          - "Podfile"
          - "package.json"
          - "tsconfig.json"
          - ".eslintrc*"
          - "*.yml"
          - "*.yaml"
          - "Dockerfile"
          - "*.config.js"

  documentation:
    description: "README files, docs, and comments"
    detection:
      file_patterns:
        all:
          - "README*"
          - "*.md"
          - "*.adoc"
          - "*.rst"
          - "/docs/*"
          - "/documentation/*"

context_rules:
  principle_applicability:
    accessibility:
      applies_to: ["ui_code"]
      severity: "critical"
    
    testing_coverage:
      applies_to: ["business_logic", "data_layer"]
      threshold: 80
      severity: "blocking"
    
    design_integrity:
      applies_to: ["ui_code"]
      severity: "required"
    
    localization:
      applies_to: ["ui_code", "business_logic"]
      severity: "required"
    
    unidirectional_data_flow:
      applies_to: ["ui_code", "business_logic"]
      severity: "required"
    
    zero_todos:
      applies_to: ["all"]
      severity: "required"
    
    documentation:
      applies_to: ["business_logic", "data_layer", "configuration"]
      severity: "recommended"

  exception_patterns:
    generated_code:
      patterns:
        - "Generated by"
        - "Autogenerated"
        - "@generated"
        - "Code generated by"
      
      rule: "Skip most checks except security"
    
    third_party:
      patterns:
        - "/vendor/*"
        - "/node_modules/*"
        - "/Pods/*"
        - "/.gradle/*"
      
      rule: "Skip all checks"
    
    legacy_code:
      patterns:
        - "@legacy"
        - "TODO: Legacy migration"
      
      rule: "Apply security and critical checks only"
